#!/bin/bash
# ==============================================
# ğŸ” SCRIPT DE VALIDATION IPS MULTI-VENDOR
# ğŸ§ª Tests contrÃ´lÃ©s pour validation dÃ©tection
# ğŸ¯ Usage exclusif en environnement de lab
# ==============================================

# VÃ©rifier si une cible est fournie
if [ $# -eq 0 ]; then
    echo "Usage: $0 <lab_target_ip>"
    echo "Exemple: $0 192.168.1.100"
    exit 1
fi

LAB_TARGET="$1"
echo "ğŸ”¬ DÃ©marrage tests de validation IPS sur $LAB_TARGET"

# ==================== TESTS DE DÃ‰TECTION ====================
echo "ğŸ§ª Tests patterns de dÃ©tection..."

# Patterns Shellshock (pour validation signatures)
echo "ğŸ“ Patterns Shellshock (dÃ©tection uniquement)..."
curl -s -H "User-Agent: Test-Shellshock-Detection-1" http://$LAB_TARGET/ > /dev/null 2>&1

# Patterns Directory Traversal (dÃ©tection uniquement)
echo "ğŸ“ Patterns Directory Traversal (dÃ©tection uniquement)..."
curl -s "http://$LAB_TARGET/Test-Directory-Traversal-Pattern" > /dev/null 2>&1

# ==================== SCAN DE VALIDATION ====================
echo "ğŸ” Scan de validation des services..."
nmap -sV -T2 $LAB_TARGET > /dev/null 2>&1

# ==================== TESTS DE COMPORTEMENT ====================
echo "ğŸ“Š Tests de comportement rÃ©seau..."
for i in {1..5}; do
    curl -s "http://$LAB_TARGET/test$i" > /dev/null 2>&1 &
done
wait

echo "âœ… Tests de validation IPS terminÃ©s"
echo "ğŸ“Š VÃ©rifiez les logs de dÃ©tection dans vos solutions sÃ©curitÃ©"